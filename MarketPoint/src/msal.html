<!doctype html>
<html lang="en">

<head>
    <link rel="preload" as="script" href="./js/msal-browser.js">
    <script language="javascript" type="text/javascript" src="./js/msal-browser.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="./css/app1.css">

    <title>Login | MarketPoint</title>

    <script>
        // Msal
        const userHint = getUrlParameters();
        const MSAL = window.msal;
        const scopes = ['api://a50bf762-1619-4252-8cd5-0a261d0c631b/ApiAccess'];
        const accessTokenRequest = {
            scopes: scopes
        };

        const msalConfig = {
            auth: {
                clientId: '3e20ecb2-9cb0-4df1-ad7b-914e31dcdda4',
                redirectUri: `${window.location.origin}/msal.html`,
                authority: 'https://login.microsoftonline.com/3e20ecb2-9cb0-4df1-ad7b-914e31dcdda4/',
                navigateToLoginRequestUrl: false
            },
            cache: {
                cacheLocation: 'localStorage',
                storeAuthStateInCookie: false,
                secureCookie: false
            },
            system: {
                tokenRenewalOffsetSeconds: 60,
                loadFrameTimeout: 9000,
                asyncPopups: false
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);


        msalInstance.handleRedirectPromise()
            .then((accessToken) => {
                if (accessToken !== null) {
                    processAccessToken(accessToken);
                }
            })

            .catch((error) => {
            })
    </script>
</head>

<body class="login">
    <div class="centered-content">
        <a class="waves-effect waves-light loggingin">Signing in...</a>
        <div class="preloader-wrapper big active">
            <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="gap-patch">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</body>

</html>